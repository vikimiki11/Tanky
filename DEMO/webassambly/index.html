<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" href="css.css">
</head>
<body>
	<div class="container">
		<div>
			<p class="bigger">JAVASCRIPT VS. WEBASSEMBLY</p>
			<p class="big">PERFORMANCE COMPARISON</p>
			<div class="buttons">
				<a href="#" id="noiseBtn" class="btn">NOISE</a>
				<a href="#" id="clearBtn" class="btn">CLEAR</a>
			</div>
			<div class="boxes">
				<div id="radio" class="radio">
					<input type="radio" id="js-box" name="algorithm" checked />
					<label for="js-box">JAVASCRIPT</label>
					<input type="radio" id="wasm-box" name="algorithm" />
					<label for="wasm-box">WEBASSEMBLY</label>
				</div>
				<div id="sorry" class="lame" style="display:none">
					NO WEBASSEMBLY SUPPORT.
				</div>
			</div>
			<div><span class="bigger">FRAME RATE</span></div>
			<div><span id="fps" class="huge">0</span></div>
			<div><span class="big">FPS</span></div>
			<p class="description">
				This is a simulation of the <a href="https://en.wikipedia.org/wiki/Wave_equation">wave equation</a>
				<span class="eq">&#8706;<sup>2</sup>u/&#8706;t<sup>2</sup> =
					c<sup>2</sup>(&#8706;<sup>2</sup>u/&#8706;x<sup>2</sup>+&#8706;<sup>2</sup>u/&#8706;y<sup>2</sup>)</span>
				across a circular 2D manifold. Use the mouse to create waves.
			</p>
			<p class="description">
				This is becoming a demonstration of how extensively Codepen messes with JavaScript; the performance of the
				JavaScript version has been deteriorating over time. It's not normally this much slower than WebAssembly.
			</p>
			<p class="description">
				It contains two implementations of the same C code: one transpiled by hand to JavaScript, and one compiled
				by Enscripten to WebAssembly.
				This particular algorithm processes large arrays and performs a lot of integer math (but does no floating
				point calculations).
				Memory is shared between JS and WebAssembly with no copying, and almost all CPU time is spent in the
				algorithm itself.
				(The canvas API introduces a minor overhead of about 10%.)
				There is a modest speedup when the same code is run in a WebAssembly context as opposed to a JavaScript
				context.
			</p>
			<p class="description"><a href="https://github.com/jtiscione/webassembly-wave">Github repository</a></p>
		</div>
		<div>
			<canvas id="canvas" width="550" height="550"></canvas>
		</div>
	</div>
	<script src="js.js"></script>
</body>
</html>